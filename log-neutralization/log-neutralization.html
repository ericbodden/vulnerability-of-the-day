<h2>Log Neutralization</h2>
<p>
	<b>Description. </b> See <a
		href="http://cwe.mitre.org/data/definitions/117.html">CWE-117</a>. If
	you allow newlines in your logs, then attackers can forge log entries,
	throwing investigations off. Related to generalized CRLF Injection ( <a
		href="http://cwe.mitre.org/data/definitions/93.html">CWE-93</a>)
</p>
<p>
	<b>Examples:</b>
</p>
<ul>
	<li><a href="log-neutralization.zip">log-neutralization.zip</a></li>.
	Run
	<code>./make</code>
	instead of
	<code>make</code>
	<li>PayPal had this issue hit them (<a
		href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-0201">CVE-2006-0201</a>)
	</li>
</ul>
<p>
	<b>Mitigations: </b>
</p>
<ul>
	<li>Don't allow newlines in your logs - remove them entirely.</li>
	<li>Depending on what tools are used to analyze logs, the CRLF
		character might not be enough. Consider <code>&lt;br&gt;</code> if
		you can view logs online, too.
	</li>
	<li>Don't forget to log the situation where a newline is
		injected, too.</li>
</ul>
<p>
	<b>Notes</b>
</p>
<ul>
	<li>This is one vulnerability that is explicitly a <em>repudiation</em>
		threat.
	</li>
	<li>By itself, this is pretty innocuous. In conjunction with
		other attacks, an attacker can provide misinformation in the logs
		that throws off the post-exploit investigation.</li>
	<li>Developers who have access to previous logs (or similar logs)
		can easily guess or reverse-engineer your patterns, making the result
		indistinguishable. Take a look at <a
		href="http://capec.mitre.org/data/definitions/93.html">CAPEC
			attack pattern 93</a>.
	</li>
	<li>Oddly enough, common logging libraries like <code>java.util.logging</code>
		and <code>log4j</code> don't have an option to remove newlines.
	</li>
</ul>