<h2>Log overflow</h2>

<p>
	<b>Description. </b> See <a
		href="http://cwe.mitre.org/data/definitions/400.html">CWE-400</a> for
	a general description. Related CWEs are <a
		href="http://cwe.mitre.org/data/definitions/779.html">CWE-779</a> and
	<a href="http://cwe.mitre.org/data/definitions/770.html">CWE-770</a>.
	Printing out to a console or logger usually ends up in a text file. If
	an attacker knows this, and the logging is unrestricted, then
	attackers can fill up the log file and crash the machine by filling up
	the hard drive. This is a denial of service attack that is
	particularly difficult to recover from. Plus, weird things happen when
	the entire hard drive is completely out of bytes, so attackers can
	take advantage of this.
</p>

<p>
	<b>Examples:</b> <a href="log-overflow.zip">log-overflow.zip</a>.
	Linux kernel has had this issue as well.
</p>
<p>
	<b>Mitigations: </b>
</p>
<ul>
	<li>Use a logging library (e.g. log4j). In configuring your
		logger, be sure to use rolling log files. These can be rotated on a
		daily basis, or by size.</li>
	<li>Be sure to actually test this functionality yourself.</li>
</ul>
<p>
	<b>Notes</b>
</p>
<ul>
	<li>Mostly an issue in applications that run on servers, although
		desktop clients are not immune to this</li>
	<li>The disadvantage of this mitigation is that you can
		potentially lose your logs if they get over-rotated. Attackers can
		potentially take advantage of this fact by intentionally overflowing
		the logs to erase the evidence. But other protections, like request
		limits, can mitigate that problem too.</li>
	<li>As a general rule, avoid unlimited hard drive storage (e.g.
		uploading photos). Sometimes it's easier to just store images as
		BLOBS in a database (where the table sizes are often limited by
		default), as opposed to dealing with the OS directly.</li>
</ul>