<h2>Open Redirect</h2>
<p>
	<b>Description. </b> See <a
		href="http://cwe.mitre.org/data/definitions/601.html">CWE-601</a>
</p>
<p>
	<b>Examples:</b>
</p>
<ul>
	<li><a href="open-redirect.zip">open-redirect.zip</a>. Using the
		XSS web application example, place this JSP page into the <code>webapps/xss/</code>
		folder.</li>
	<li>Also, the popular bug tracking engine Trac <a
		href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-2951">had
			one of these</a>, take a look at <a
		href="http://trac.edgewall.org/changeset/7224/branches/0.10-stable">the
			fix</a>.
	</li>
</ul>
<p>
	<b>Mitigations: </b>
</p>
<ul>
	<li>Input validation, although more than just validating
		character strings - look up the URL itself. Make your whitelist a set
		of known, safe, URLs within your app. Only allowing input that
		redirects to your own site is also a big step.</li>
	<li>Like file paths and path traversal vulnerabilities, URLs can
		get pretty complicated. Java has a <code>normalize()</code> method in
		the <a
		href="http://docs.oracle.com/javase/7/docs/api/java/net/URI.html#normalize%28%29">URI</a>
		class that helps you canonicalize your URL before checking it. This
		is especially helpful if you are in an untrusted site situation (e.g.
		your webapp is hosted on the same site as untrusted webapps and you
		want to block intra-site redirects like <code>../evilsite</code>).
	</li>
</ul>
<p>
	<b>Notes</b>
</p>
<ul>
	<li>While our example uses a form post, exploits more often occur
		in URL parameters (e.g. <code>http://yourwebsite.com/somethingvulnerable.jsp?redirect=www.evilwebsite.com</code>)
	</li>
	<li>Detecting this one is the hard part. Most usages of redirects
		are when the URLs are not connected to user input (and are therefore
		safe). But, whenever user input eventually leads to a redirect,
		consider this issue.</li>
	<li>This is a popular vulnerability used in phishing attacks
		(i.e. social engineering). Suppose PayPal had an open redirect
		vulnerability. Then an attacker could spam people asking them to
		check their paypal accounts. The URLs start with <code>paypal.com</code>,
		so most users would consider them safe and click through.
	</li>
</ul>
