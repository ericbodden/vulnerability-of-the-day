<h2>Path Traversal</h2>
<p>
	<b>Description. </b> See <a
		href="http://cwe.mitre.org/data/definitions/22.html">CWE-22</a>
</p>
<p>
	<b>Examples:</b> <a href="path-traversal.zip">path-traversal.zip</a>.
	Also, see <a href="http://tomcat.apache.org/security-5.html">this
		issue (CVE-2009-2902)</a> or its entry in the <a
		href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-2902">CVE</a>
	in Tomcat where they allowed web applications be named "...war", which
	could be used for arbitrary file deletion outside of the webapp
	sandbox.
</p>

<p>
	<b>Mitigations: </b>
</p>
<ul>
	<li>Remember that path strings are very flexible - they can be
		relative or absolute. So <code>a/b/c.txt</code> is the same as <code>a/b/../b/c.txt</code>.
		The <em>canonical</em> form of any file is just the absolute path
		name, e.g. <code>/home/someone/a.txt</code>
	</li>
	<li>Better to leave the canonicalization to the programming
		language. Java uses <code>getCanonicalPath()</code>, it's called <code>realpath()</code>
		in C, PHP, and Perl. They actually ping the filesystem to interpret
		the path string.
	</li>
	<li>Tactic: canonicalize your sandboxed directory, canonicalize
		the final filename you are about to open, and compare the two with <code>startsWith</code>.
	</li>
</ul>
<p>
	<b>Notes</b>
</p>
<ul>
	<li>Another one that's common to web applications especially.
		This often appears in PHP apps that delegate code to the operating
		system, or use flat file storage.</li>
	<li>Akin to SQL Injection where it's string concatenation gone
		wrong. Sadly, there's no version of a prepared statement for files
		(e.g. set the directory separately from the file name), so <code>new
			File(sandbox, filename)</code> is still vulnerable to this.
	</li>
	<li>The myriad of exploits for this one over the years has shown
		that blacklisting is not a good approach. Better to just convert to
		absolute, and check the directory from there.</li>
	<li>Can also be a danger with configuration files. In the
		interest of defense in depth, it might be wise to do this kind of
		check when a properties file contains the name of another file.</li>
</ul>