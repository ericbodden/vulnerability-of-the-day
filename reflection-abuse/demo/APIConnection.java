// Copyright 2012 Andrew Meneely. 
// Licensed under the Educational Community License, Version 2.0 (the "License"); 
// you may not use this file except in compliance with the License. 
// You may obtain a copy of the License at http://www.osedu.org/licenses/ECL-2.0. 
// Unless required by applicable law or agreed to in writing, 
// software distributed under the License is distributed on an "AS IS" BASIS, 
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. 
// See the License for the specific language governing permissions 
// and limitations under the License.

/**
 * This is an example class with a secret stored in its private field.
 * @author Andy Meneely
 * 
 */
public class APIConnection {

	// assume this isn't hardcoded, but obtained securely
	private String token = "that token was a secret!";

	public APIConnection() {}

	/**
	 * A public method that requires authentication first, 
	 * but from an untrusted API in the same virtual machine.
	 * @param tokenGuess
	 */
	public void doSomething(String tokenGuess) {
		if (token.equals(tokenGuess)) {
			doSomethingSecret();
		}
	}

	/**
	 * This method is supposed to be protected, 
	 * but using reflection, it can be directly invoked.
	 */
	private void doSomethingSecret() {
		System.out.println("You are authenticated! Now let's do some sensitive stuff.");
	}
}
