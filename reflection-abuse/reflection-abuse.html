<h2>Java Reflection Abuse</h2>
<p>
	<b>Description. </b> See <a
		href="http://cwe.mitre.org/data/definitions/470.html">CWE-470</a>.
	Despite what you might assume, Java allows you to access private
	variables in other classes via its Reflection API. In untrusted API
	situations (e.g. plug-in architectures), this can lead to malicious
	libraries accessing and tampering with sensitive data.
</p>
<p>
	<b>Examples:</b>
</p>
<ul>
	<li><a href="reflection-abuse.zip">reflection-abuse.zip</a>.
		Running <code>make</code> will result in the exploit, <code>make
			safe</code> results in running it under a security manager.</li>
	<li>The ColdFusion database access API has this vulnerability (<a
		href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-2331">CVE-2004-2331</a>)
	</li>
</ul>
<p>
	<b>Mitigations: </b>
</p>
<ul>
	<li>Use the Java Security Manager to limit privileged API
		situations. While this feature is turned off by default, it's
		actually critical for deploying a Java application securely (e.g. in
		a servlet container).</li>
</ul>
<p>
	<b>Notes</b>
</p>
<ul>
	<li>Many Java servers utilize a strict, security policy (<a
		href="http://tomcat.apache.org/tomcat-7.0-doc/security-manager-howto.html">e.g.
			Tomcat</a>), however, many default installations of such servers do not
		force you to set up your security policy with the Java virtual
		machine.
	</li>
	<li>The Java security manager blocks all kinds of other sensitive
		actions, such as <code>System.exit(1);</code>, file system access, or
		using reflection to instantiate singletons.
	</li>
	<li>The Deployment &amp; Distribution lecture covers more details
		on the Java Security Manager</li>
	<li>PHP also allows this kind of behavior, and third-party
		security manager libraries provide similar functionality as the Java
		Security Manager.</li>
</ul>