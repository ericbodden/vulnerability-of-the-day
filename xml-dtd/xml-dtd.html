<h2>XML Embedded DTDs</h2>
<p>
	<b>Description. </b> See <a
		href="http://cwe.mitre.org/data/definitions/827.html">CWE-827</a>.
	XML allows for validation of their input using Document Type
	Definitions (DTDs). These DTDs are pretty flexible, and allow for
	things like reading in external files. However, users can embed their
	own DTDs in the header of an XML file, thereby accessing the file
	system directly.
</p>
<p>
	<b>Examples:</b> <a href="xml-dtd.zip">xml-dtd.zip</a>.
</p>
<p>
	<b>Mitigations: </b>
</p>
<ul>
	<li>In most languages, you can disable validation of embedded
		DTDs with ease.</li>
	<li>However, make sure you test this closely, as Java's built-in
		SAX parser does not always respect <code>setValidating(false)</code>
		and <code>setExpandEntityReferences(false)</code> depending on the
		environment. In that case, you need to override the entity resolver
		(see the given example).
	</li>
</ul>
<p>
	<b>Notes</b>
</p>
<ul>
	<li>Ironically, DTDs were originally intended for XML validation,
		but it got warped into more of a user convenience. So yes, fixing
		this vulnerability means <em>turning off</em> "validation".
	</li>
	<li>A similar vulnerability is the <a
		href="http://cwe.mitre.org/data/definitions/776.html">XML bomb</a>,
		which expands XML entities expoentially (causing a DoS by filling up
		the memory). However, most XML parsers have limiting defaults for
		expanding XML entities, so that XML bombs are (practically speaking)
		no longer an issue as long as developers don't explicitly turn off
		the limits. An example XML bomb is included in the above zip.
	</li>
</ul>